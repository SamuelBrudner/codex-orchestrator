{"id":"codex-3k9","title":"Handle ambiguous base_branch checkout when multiple remotes define the branch","description":"autoencoded_vocal_analysis failed branch setup: base_branch=master with both origin/master and upstream/master present causes 'git checkout master' ambiguous error. Orchestrator should resolve ambiguous base_branch by preferring a configured default remote (e.g., origin), or using fully-qualified refs (origin/\u003cbranch\u003e) when multiple remotes provide the branch.","status":"tombstone","priority":2,"issue_type":"bug","owner":"samuel.brudner@gmail.com","created_at":"2026-01-22T20:31:42.08225-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-28T22:43:32.660807-05:00","deleted_at":"2026-01-28T22:43:32.660807-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"codex-3og","title":"Add juvenile_learning_tda to home_projects inventory","status":"tombstone","priority":2,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-01-27T13:41:25.906626-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-28T22:43:32.660807-05:00","close_reason":"Completed","deleted_at":"2026-01-28T22:43:32.660807-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"codex-g3r","title":"Auto-clean or isolate repo after failed bead to avoid dirty skip","description":"During RUN_ID=20260122-222658-5f201006, home_science and lab_tracker beads failed validation (pytest -q exit 2) after making changes; no commit was created and the worktrees were left dirty. Subsequent ticks skipped with git_dirty. We need a policy to keep repos clean after failed beads (e.g., auto-revert, or commit WIP and keep bead open, or isolate changes in a scratch worktree), so unattended runs can continue.","notes":"Added missing-module detection in validation retry context and env refresh when dependency files change (pyproject/environment/requirements). Dirty-worktree cleanup after failed bead still pending.","status":"tombstone","priority":1,"issue_type":"bug","owner":"samuel.brudner@gmail.com","created_at":"2026-01-22T20:31:28.02916-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-28T22:43:32.660807-05:00","close_reason":"Implemented failure snapshots and amend-on-close","deleted_at":"2026-01-28T22:43:32.660807-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"codex-kfe","title":"Inject commit message guidance into AGENTS.md for new repos","status":"tombstone","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-01-27T12:39:44.710037-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-28T22:43:32.660807-05:00","close_reason":"Completed","deleted_at":"2026-01-28T22:43:32.660807-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"feature"}
{"id":"codex-orchestrator-1","title":"Bootstrap project scaffolding (package + CLI + tests)","description":"Create the minimal runnable codex-orchestrator codebase: Python package skeleton, CLI entrypoint(s), and test harness.","acceptance_criteria":"A CLI help command runs successfully; repository has a clear src/ package layout; tests can be executed.","notes":"Epic closure: base repo scaffolding is now in place and validated.\n\n- Package uses `src/` layout under `src/codex_orchestrator/`.\n- CLI help works (see `tests/test_cli_smoke.py`).\n- Tests run successfully in the repo conda env: `conda run -n codex-orchestrator python -m pytest`.\n- Repo-local dev environment is declared in `environment.yml` (`pip: -e \".[dev]\"`).\n\nThis epic is satisfied by the completed child scaffolding plus subsequent implementation beads that kept the harness green.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-14T11:16:59.850854-05:00","updated_at":"2025-12-15T22:00:38.759822-05:00","closed_at":"2025-12-15T22:00:38.759822-05:00"}
{"id":"codex-orchestrator-10","title":"Per-repo execution engine (Codex + bd state updates)","description":"Execute work units for a repo within a run: acquire per-repo lock, operate on run/\u003cRUN_ID\u003e branch, iterate immutable deck items under timeboxing, invoke codex exec --full-auto, enforce safety boundaries, run validations, and update/close Beads with auditable commits and downstream updates.","design":"Spec alignment highlights:\n\n- Per-repo isolation:\n  - Strict serialization per repo via filesystem locks.\n  - Repo work runs on run/\u003cRUN_ID\u003e branch (branch-first safety).\n\n- Timeboxing and stopping rules:\n  - Work is time-bounded per tick and per bead.\n  - Do not start a new bead if fewer than 15 minutes remain in the tick.\n  - Cap beads per repo per tick (default 2–3).\n  - If blocked by tests, environment, or scope ambiguity, stop and write bead updates instead of continuing.\n\n- Codex invocation policy:\n  - Use codex exec --full-auto for unattended execution (no interactive prompts).\n\n- Git operations:\n  - Orchestrator owns staging and commits.\n  - Default granularity: one commit per bead.\n  - Commit message format: beads(\u003cid\u003e): \u003ctitle\u003e with RUN_ID in commit body.\n  - No merge; no push by default.\n\n- Guardrails and safety boundaries:\n  - Edits constrained to allowed_roots/deny_roots.\n  - Diff size capped per tick (files changed and lines added).\n  - Unattended command execution is allowlisted (git read-only, env activation, tests, formatting).\n  - No long-running training or simulations.\n\n- Testing and close gates:\n  - Declared validation_commands must pass to close a bead, plus at least one behavioral test.\n  - Pre-existing failures are recorded by the planner and must be explicitly scoped or fixed before close.\n\n- Notebook policy:\n  - Execute notebooks only when explicitly required by the bead contract.\n  - Output handling follows repo notebook_output_policy (default strip).\n  - Refactor threshold: reusable multi-cell logic must be extracted into src/.\n\n- DRY escalation and workflow awareness:\n  - Similar changes in two or more notebooks must be consolidated into shared modules.\n  - Propose Snakemake only for true multi-step dependency graphs; avoid repo-wide restructures in one run.\n\n- Beads updates:\n  - Update Beads states open -\u003e in_progress -\u003e closed with notes.\n  - On bead close, identify downstream beads via dependency graph and update their bodies with a short status/context note.","acceptance_criteria":"Execution is serialized per repo with filesystem locks.\n\nWithin a repo, the orchestrator:\n\n- Works only from the immutable run deck for the current RUN_ID (no mid-run drift).\n- Respects timeboxing rules (including the \u003c15 minutes remaining rule and per-tick bead caps).\n- Invokes codex exec --full-auto and captures invocations in logs.\n- Constrains file edits to allowed_roots/deny_roots and enforces per-tick diff caps.\n- Runs declared validation_commands and requires at least one behavioral test before closing beads.\n\nConservative replanning policy (v1):\n\n- If a deck item’s Beads issue is already closed, execution skips it (and records the reason) rather than replanning.\n- If a deck item’s Beads issue is blocked, execution skips it (and records the reason) rather than replanning.\n- Execution does not add newly-created or newly-ready beads to the current run deck unless an explicit replanning mode is enabled.\n\nFor each bead completed:\n\n- Beads issue transitions to in_progress then closed with clear notes.\n- Exactly one commit is created by default with message beads(\u003cid\u003e): \u003ctitle\u003e and RUN_ID included in the commit body.\n- Downstream beads (from the dependency graph) are updated with a short status/context note.","notes":"Upstream from codex-orchestrator-4 is now implemented:\n\n- Run deck schema v2 (`src/codex_orchestrator/planner.py`): each deck item embeds an immutable `contract` snapshot plus `baseline_validation` results (per validation command).\n- Planning pass entrypoint: `ensure_repo_run_deck(...)` in `src/codex_orchestrator/planning_pass.py`:\n  - Runs `bd init --quiet`, `bd list --json` (known ids for overlay validation), and `bd ready --json` (ready beads) in the target repo.\n  - Validates `config/bead_contracts/\u003crepo_id\u003e.toml` via `plan_deck_items(...)` (unknown bead override tables fail loudly).\n  - Runs baseline validation commands via `run_validation_commands(...)` and writes `\u003ccache\u003e/runs/\u003cRUN_ID\u003e/\u003crepo_id\u003e.deck.\u003cYYYY-MM-DD\u003e.json` atomically.\n- Conservative replanning: if an existing deck is found for (RUN_ID, repo_id), `ensure_repo_run_deck(replan=False)` reuses it and does not call bd/validations; `replan=True` is the explicit escape hatch.\n- Deck IO helpers: `read_run_deck(...)` / `load_existing_run_deck(...)` (`src/codex_orchestrator/planner.py`) and `OrchestratorPaths.find_existing_run_deck_path(...)` (`src/codex_orchestrator/paths.py`).\n- Contract snapshot parsing added: `ResolvedExecutionContract.from_json_dict(...)` (`src/codex_orchestrator/contracts.py`) for execution-time deck loading.\n\nExecution engine implemented:\n\n- `src/codex_orchestrator/repo_execution.py`: `execute_repo_tick(...)` (immutable deck execution + timeboxing + per-tick diff caps + safety boundaries + codex invocation + validation/close gates + bd state updates + one-commit-per-bead + downstream dependent updates) and `execute_repos_tick(...)` (parallel across repos).\n- `src/codex_orchestrator/codex_subprocess.py`: `codex exec --full-auto` wrapper (stdin prompt, timeouts, captured output).\n- `src/codex_orchestrator/git_subprocess.py`: git safety helpers + diff stats + allowed_roots/deny_roots enforcement.\n- `src/codex_orchestrator/beads_subprocess.py`: `bd show/update/close --json` wrappers used during execution.\n- `src/codex_orchestrator/paths.py`: per-repo lock paths (`repo_locks_dir`, `repo_lock_path`).\n- `src/codex_orchestrator/run_lock.py`: in-process guard to prevent same-process double-acquire.\n- `src/codex_orchestrator/cli.py`: `codex-orchestrator exec-repo` CLI for running one repo deck tick.\n\nTests added:\n\n- `tests/test_repo_execution_integration.py`\n- `tests/test_repo_execution_gating.py`\n\nLocal validation: `python3 -m compileall -q src tests` (pytest not available in this environment).\n\nImplementation commit: 614ccb8 (beads(codex-orchestrator-10): per-repo execution engine)\nTests: conda run -n codex-orchestrator python -m pytest (23 passed)","status":"closed","priority":1,"issue_type":"epic","assignee":"codex","created_at":"2025-12-14T12:00:06.618065-05:00","updated_at":"2025-12-15T14:09:18.623355-05:00","closed_at":"2025-12-15T13:45:40.565064-05:00","dependencies":[{"issue_id":"codex-orchestrator-10","depends_on_id":"codex-orchestrator-4","type":"blocks","created_at":"2025-12-15T07:03:06.356114-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-10","depends_on_id":"codex-orchestrator-8","type":"blocks","created_at":"2025-12-15T07:03:06.426082-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-10","depends_on_id":"codex-orchestrator-9","type":"blocks","created_at":"2025-12-15T07:03:06.493118-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-11","title":"Set up Python package skeleton (pyproject + src/ layout)","description":"Create the minimal Python package layout for the orchestrator (src/ package, pyproject.toml) and choose baseline tooling (Python\u003e=3.10, pytest, ruff).","acceptance_criteria":"The CLI help can import the package; pytest runs (even if only a smoke test); ruff config is present.","notes":"Implemented initial Python package skeleton.\n\n- Added `pyproject.toml` with src/ layout, console script entrypoint, and ruff/pytest config.\n- Added `src/codex_orchestrator` package with `codex-orchestrator` CLI stub and `python -m codex_orchestrator` support.\n- Added a smoke test (`tests/test_cli_smoke.py`) that runs CLI help with `PYTHONPATH=src`.\n\nValidation notes:\n- In this sandbox, `pytest`/`ruff` are not installed (both `python3 -m pytest` and `python3 -m ruff` fail). Once installed, run: `python3 -m pip install -e '.[dev]'` then `pytest -q` and `ruff check .`.\n- Verified locally here that `PYTHONPATH=src python3 -m codex_orchestrator --help` exits 0.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T12:19:23.628918-05:00","updated_at":"2025-12-14T21:04:27.972807-05:00","closed_at":"2025-12-14T21:04:27.972807-05:00","dependencies":[{"issue_id":"codex-orchestrator-11","depends_on_id":"codex-orchestrator-1","type":"parent-child","created_at":"2025-12-14T12:28:32.308954-05:00","created_by":"samuelbrudner"}]}
{"id":"codex-orchestrator-12","title":"Add plumeGradMotion repo entry","description":"Add the first target repo to orchestrator configuration: plumeGradMotion at the given Dropbox path, using conda env plume_grad_motion.","acceptance_criteria":"config/repos.toml contains a repos.plume_grad_motion entry with correct path, base_branch, and env; config/bead_contracts/plume_grad_motion.toml exists with sane defaults.","notes":"Implemented initial repo inventory + contract overlay for plumeGradMotion.\n\nNotes:\n- Target repo base branch inferred from local branches: `main` exists.\n- Repo working tree is currently dirty (will be skipped by orchestrator until clean).\n- Repo-level env set to `plume_grad_motion` per instruction; repo's `environment.yml` currently declares `name: plumeGradMotion`.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T20:30:05.315644-05:00","updated_at":"2025-12-14T20:45:35.905373-05:00","closed_at":"2025-12-14T20:45:35.905373-05:00","dependencies":[{"issue_id":"codex-orchestrator-12","depends_on_id":"codex-orchestrator-2","type":"discovered-from","created_at":"2025-12-14T20:30:11.934285-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-13","title":"Overlay validation for contract overlays","description":"Parse+validate config/bead_contracts/\u003crepo_id\u003e.toml ([defaults] + per-bead overrides). Enforce: unknown bead IDs hard-fail; allowed_roots may only narrow repo policy; deny_roots may not relax repo policy.","acceptance_criteria":"Valid overlays pass; unknown bead IDs fail loudly; allowed_roots expansion fails; deny_roots relaxation fails.","notes":"Context from codex-orchestrator-2:\n\n- Repo inventory + validation implemented in `src/codex_orchestrator/repo_inventory.py`.\n- `RepoPolicy` exposes repo-level boundaries needed for overlay validation:\n  - `allowed_roots`, `deny_roots`, `notebook_roots` parsed as `tuple[Path, ...]` and validated as relative (no absolute paths; no '..').\n  - `validation_commands` parsed as `tuple[str, ...]`.\n  - `notebook_output_policy` validated ('strip'|'keep'), defaulting to 'strip'.\n- Unknown keys in `[repos.\u003crepo_id\u003e]` and unknown `repo_groups` members hard-fail at load time via `RepoConfigError`, so overlay validation can rely on a clean `RepoInventory.repos` keyspace.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T20:56:11.763223-05:00","updated_at":"2025-12-15T11:11:30.103239-05:00","closed_at":"2025-12-15T11:11:30.103239-05:00","dependencies":[{"issue_id":"codex-orchestrator-13","depends_on_id":"codex-orchestrator-2","type":"blocks","created_at":"2025-12-15T00:23:08.458396-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-14","title":"Resolved contract model + deterministic resolver","description":"Resolve per-bead execution contract deterministically: per-bead overrides \u003e defaults \u003e repo policy (config/repos.toml). Fail if required fields cannot be resolved; return resolved snapshot for deck items.","acceptance_criteria":"Resolver is deterministic; missing required fields produce actionable error used to skip bead; resolved contract snapshot is complete for queued beads.","notes":"Context from codex-orchestrator-2:\n\n- Repo policy layer is now concrete via `load_repo_inventory()` in `src/codex_orchestrator/repo_inventory.py`.\n- `RepoPolicy` provides repo-default fields used in resolution order (env, validation_commands, notebook_* roots, allowed/deny roots, notebook_output_policy) with strict type validation and deterministic `repo_id` keys.\n- `RepoInventory.select_repo_ids/select_repos` implements the selection union semantics for (repo_ids + repo_groups), defaulting to all repos; raises `RepoConfigError` for unknown ids/groups.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T20:56:27.853438-05:00","updated_at":"2025-12-15T11:33:20.269852-05:00","closed_at":"2025-12-15T11:33:20.269852-05:00","dependencies":[{"issue_id":"codex-orchestrator-14","depends_on_id":"codex-orchestrator-2","type":"blocks","created_at":"2025-12-15T00:23:08.528455-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-15","title":"Repo ingestion CLI (dry-run/apply) for contract overlays","description":"Add CLI to validate/generate contract overlays. dry-run: validate overlay + show missing fields for ready beads. apply: write/update config/bead_contracts/\u003crepo_id\u003e.toml in orchestrator repo.","acceptance_criteria":"dry-run exits nonzero on invalid overlays and prints next action; apply writes overlay file; unknown bead IDs fail loudly.","notes":"Implemented `codex-orchestrator overlay {dry-run,apply}`.\n\n- `overlay dry-run --repo-id \u003crepo_id\u003e` validates `config/bead_contracts/\u003crepo_id\u003e.toml` (including unknown bead id hard-fail) and resolves contracts for ready beads; exits nonzero and prints `next_action=...` for missing overlay / invalid overlay / missing required contract fields.\n- `overlay apply --repo-id \u003crepo_id\u003e` creates/updates `config/bead_contracts/\u003crepo_id\u003e.toml` with safe defaults (fills missing required fields in `[defaults]` without clobbering existing values); fails loudly if env cannot be resolved (must come from `repos.\u003crepo_id\u003e.env` or `--env`).\n\nCode: `src/codex_orchestrator/cli.py`.\nTests: `tests/test_overlay_cli.py` (uses a stub `bd` on PATH).\nValidation: `conda run -n codex-orchestrator python -m pytest` (27 passed).\n\nCommit: 0e59cb4","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2025-12-14T20:56:33.885925-05:00","updated_at":"2025-12-15T15:32:39.532717-05:00","closed_at":"2025-12-15T15:24:38.786522-05:00","dependencies":[{"issue_id":"codex-orchestrator-15","depends_on_id":"codex-orchestrator-13","type":"blocks","created_at":"2025-12-15T00:23:08.601147-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-15","depends_on_id":"codex-orchestrator-14","type":"blocks","created_at":"2025-12-15T00:23:08.671488-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-152","title":"Optional enforcement: Given/When/Then structure for new/modified tests","description":"We want behavioral tests to follow a Given/When/Then structure, but enforcement is currently only: “at least one behavioral test command ran”.\n\nAdd a lightweight v1 enforcement option that’s not brittle:\n\n- either a repo-level lint step that checks new/modified tests for G/W/T markers\n- or enforce via pre-commit hooks included in validation commands","acceptance_criteria":"- Add optional (off-by-default) enforcement that fails validation if new/modified tests lack Given/When/Then markers.\n- Document how repos should enable it (validation commands / overlay default).\n- Tests cover both enabled and disabled behavior.","notes":"Implemented optional Given/When/Then enforcement (off by default):\n\n- New contract overlay key: `enforce_given_when_then` (set in `config/bead_contracts/\u003crepo_id\u003e.toml` under `[defaults]` or per-bead).\n- Execution gate: when enabled, `execute_repo_tick` blocks closing if any changed test files are missing line-start `Given`/`When`/`Then` markers (case-insensitive; comment prefixes allowed).\n- Heuristic test file detection covers common patterns (`test_*.py`, `*_test.py`, `*.test.*`, `*.spec.*`, `__tests__/*.{js,jsx,ts,tsx}`).\n- Docs: `project_spec.md` updated with enablement instructions.\n- Tests: `tests/test_repo_execution_integration.py` covers disabled + enabled (fail/pass).\n\nLocal validation: `python -m pytest -q`","status":"closed","priority":3,"issue_type":"task","assignee":"codex","created_at":"2025-12-16T22:59:03.49417-05:00","updated_at":"2025-12-19T15:42:19.714445-05:00","closed_at":"2025-12-19T15:42:19.714445-05:00","close_reason":"Implemented optional Given/When/Then enforcement with docs + tests.","dependencies":[{"issue_id":"codex-orchestrator-152","depends_on_id":"codex-orchestrator-10","type":"discovered-from","created_at":"2025-12-16T22:59:03.495988-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-16","title":"Planner gating for ingestion + unresolvable contracts","description":"Wire overlay validation + contract resolution into planning pass. Skip beads with unresolvable contract fields and log next action. Write deck items with resolved contract snapshot.","acceptance_criteria":"Planner excludes beads with unresolved required fields; logs next action; deck contains resolved contract snapshot per item.","notes":"Context from codex-orchestrator-13:\n\n- Contract overlay parsing+validation lives in `src/codex_orchestrator/contract_overlays.py`.\n- Call `load_contract_overlay(overlay_path, repo_policy=RepoPolicy, known_bead_ids=set[str])` during the ingestion/planning gate, using bead IDs from `bd ready` (or repo issue inventory) as `known_bead_ids`.\n- Validation hard-fails unknown bead override tables and enforces overlay `allowed_roots` narrowing + `deny_roots` non-relaxation vs repo policy; missing allowed/deny keys are treated as \"not overridden\".\n\nContext from codex-orchestrator-14:\n\n- Deterministic contract resolution lives in `src/codex_orchestrator/contracts.py`.\n- For each ready bead: call `resolve_execution_contract(repo_policy=RepoPolicy, overlay=ContractOverlay, bead_id=str, overlay_path=Path|None)`.\n- On `ContractResolutionError`, log the error message as the \"next action\" and skip that bead (do not queue / do not write deck item).\n- Use `ResolvedExecutionContract.to_json_dict()` to embed an immutable contract snapshot in the deck item.\n- `validation_commands` are combined + de-duplicated: `RepoPolicy.validation_commands` + overlay `[defaults].validation_commands` + overlay per-bead `validation_commands`.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2025-12-14T20:56:40.205357-05:00","updated_at":"2025-12-15T12:00:42.262894-05:00","closed_at":"2025-12-15T12:00:42.262894-05:00","dependencies":[{"issue_id":"codex-orchestrator-16","depends_on_id":"codex-orchestrator-13","type":"blocks","created_at":"2025-12-15T00:23:08.744028-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-16","depends_on_id":"codex-orchestrator-14","type":"blocks","created_at":"2025-12-15T00:23:08.811069-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-17","title":"Fix beads-mcp close tool TypeError","description":"The beads MCP server's close/update-to-closed operations error with `BdDaemonClient.close() takes 1 positional argument but 2 were given`, preventing closing issues via mcp__beads__close.","acceptance_criteria":"Calling `mcp__beads__close` closes an issue successfully (no TypeError). Calling `mcp__beads__update` with status=closed also succeeds or fails with a clear daemon/CLI error (not the close signature TypeError).","notes":"Root cause: beads-mcp 0.11.0 defines `BdDaemonClient.close` twice (an async `close(params)` and a later no-arg `close()`), so the issue-closing method gets overwritten and `client.close(params)` raises `TypeError: BdDaemonClient.close() takes 1 positional argument but 2 were given`.\n\nFix applied on disk:\n- Patched `/Users/samuelbrudner/.local/share/uv/tools/beads-mcp/lib/python3.11/site-packages/beads_mcp/bd_daemon_client.py` to rename the async issue closer to `close_issue(...)` and make `close(params: CloseIssueParams | None = None)` a wrapper:\n  - `client.close()` -\u003e no-op shutdown hook\n  - `await client.close(params)` -\u003e delegates to `close_issue`\n\nBlocker:\n- The running beads-mcp MCP server process must be restarted to load the patched code (current process still errors). After restart, validate by closing `codex-orchestrator-18` via `mcp__beads__close`.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-14T21:29:56.182829-05:00","updated_at":"2025-12-14T22:06:59.805932-05:00","closed_at":"2025-12-14T22:06:59.805932-05:00","dependencies":[{"issue_id":"codex-orchestrator-17","depends_on_id":"codex-orchestrator-11","type":"discovered-from","created_at":"2025-12-14T21:30:02.262487-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-18","title":"MCP close smoke test (delete later)","description":"Temporary issue to validate that mcp__beads__close works after fixing beads-mcp BdDaemonClient.close method conflict.","notes":"testing update-\u003eclosed","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-14T21:31:33.317197-05:00","updated_at":"2025-12-14T22:03:58.439071-05:00","closed_at":"2025-12-14T22:03:58.439071-05:00"}
{"id":"codex-orchestrator-19","title":"Add centerline_prediction_agent_simulation repo entry","description":"Add this target repo to orchestrator configuration:\n\n- path: /Users/samuelbrudner/Yale University Dropbox/users/sam_brudner/analysis/centerline_prediction_agent_simulation/\n- conda env: antenna_filter_navigation_sim\n- validation: pytest -q\n\nAlso add a contract overlay with sane defaults under config/bead_contracts/.","acceptance_criteria":"config/repos.toml contains a repos.centerline_prediction_agent_simulation entry with correct path, base_branch, env, and basic safety roots.\n\nconfig/bead_contracts/centerline_prediction_agent_simulation.toml exists with sane defaults (time_budget_minutes, validation_commands, env, allow_env_creation=false, requires_notebook_execution=false).","notes":"Implemented repo inventory + contract overlay for centerline_prediction_agent_simulation.\n\nNotes:\n- Base branch inferred from local branches: `main` exists and is checked out.\n- Repo declares `name: antenna_filter_navigation_sim` in its `environment.yml` (matches configured env).\n- Added conservative deny_roots for data/models/caches; validation gate set to `pytest -q`.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T21:48:37.690658-05:00","updated_at":"2025-12-14T22:02:33.394897-05:00","closed_at":"2025-12-14T22:02:33.394897-05:00","dependencies":[{"issue_id":"codex-orchestrator-19","depends_on_id":"codex-orchestrator-2","type":"parent-child","created_at":"2025-12-14T21:48:44.507916-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-2","title":"Repo configuration \u0026 discovery (config/repos.toml)","description":"Implement repository inventory from config/repos.toml: parse + validate repo entries, assign stable repo_id keys, and support repo_groups for subset selection.","design":"Spec alignment:\n\n- Repo configs live under repos.\u003crepo_id\u003e with required fields (path, base_branch) and optional fields (env, notebook_roots, allowed_roots, deny_roots, validation_commands, notebook_output_policy).\n- Each repo has a stable repo_id (the key used in repos.\u003crepo_id\u003e), used for decks, cache paths, log naming, and selection.\n- Repo groups are declared under [repo_groups] as lists of repo_id values (e.g. fly_navigation_repos, automation_repos, home_projects).\n- Default target set is all repos.*; selection may include repo_groups and/or explicit repo_id values; targets are the union.\n- Fail loudly if a group references an unknown repo_id.","acceptance_criteria":"Given a config/repos.toml containing repos.* and optional repo_groups:\n\n- Orchestrator enumerates repos deterministically (stable ordering).\n- Validation fails loudly with actionable errors when required fields are missing or malformed.\n- repo_id is stable and used for downstream caching/log naming.\n- repo_groups resolve to known repo_id values; unknown references hard-fail before any work.\n- Given selection inputs (repo_ids and/or repo_groups), orchestrator computes the target repo set as the union; when unspecified, defaults to all repos.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-14T11:18:34.993747-05:00","updated_at":"2025-12-15T10:05:55.958156-05:00","closed_at":"2025-12-15T10:05:55.958156-05:00"}
{"id":"codex-orchestrator-2kt","title":"CLI: view planning audit artifacts","description":"Add CLI/UX helpers to inspect planning audit artifacts for a given RUN_ID/repo (print paths, open or dump contents), improving operator ergonomics.","acceptance_criteria":"- New CLI command supports selecting RUN_ID + repo_id and:\n  - prints audit artifact paths and existence\n  - optionally prints the markdown to stdout (or JSON)\n- Clear, actionable error when artifacts are missing.\n- Includes at least one CLI smoke test.","notes":"Implemented planning-audit CLI viewer.\n\nCommits:\n- 0e22497 (feat(cli): add planning-audit viewer command)\n\nManual verify:\n- PYTHONPATH=src python -m codex_orchestrator planning-audit --repo-id \u003crepo_id\u003e --run-id \u003cRUN_ID\u003e\n- uv run --extra dev -m pytest -q tests/test_planning_audit_cli.py","status":"closed","priority":3,"issue_type":"feature","assignee":"codex","created_at":"2025-12-16T21:44:28.20636-05:00","updated_at":"2025-12-16T22:42:02.744669-05:00","closed_at":"2025-12-16T22:42:02.744669-05:00","dependencies":[{"issue_id":"codex-orchestrator-2kt","depends_on_id":"codex-orchestrator-n19","type":"discovered-from","created_at":"2025-12-16T21:44:28.208216-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-2l2","title":"Run repos in parallel with independent tick budgets","description":"Ensure repos execute in parallel by default so later repos are not starved. Each repo should get its own tick budget window (not a shared global tick), and the default max_parallel should allow concurrent runs without manual flags.","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-01-29T14:47:05.364329-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-29T14:50:12.575825-05:00","closed_at":"2026-01-29T14:50:12.575825-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-2lg","title":"Polish: ruff/mypy cleanups for run signoff","description":"Fix any lint (ruff line-length, etc.) introduced by run signoff work; ensure error messages are actionable. Keep changes minimal.","acceptance_criteria":"- ruff passes.\n- No new mypy issues introduced.","notes":"Completed (minimal):\n\n- Updated Ruff config in `pyproject.toml`: `line-length = 160` (avoids repo-wide reflow for E501).\n- Applied Ruff auto-fixes limited to import hygiene:\n  - `I001` import ordering\n  - `UP035` move `Sequence`/`Mapping`/`Iterable` imports to `collections.abc`\n\nVerification:\n- `.venv/bin/ruff check .`\n- `.venv/bin/python -m compileall -q src tests` (mypy not installed/configured)\n- `PATH=\"$(pwd)/.venv/bin:$PATH\" .venv/bin/python -m pytest` (50 passed)\n\nNo behavior changes intended; changes are config + import-only.","status":"closed","priority":2,"issue_type":"task","assignee":"gpt-5.2","created_at":"2025-12-17T13:19:02.091611-05:00","updated_at":"2025-12-18T11:59:46.620337-05:00","closed_at":"2025-12-18T11:59:46.620337-05:00","close_reason":"Ruff passes via line-length=160 + import-only fixes; compileall and pytest verified.","dependencies":[{"issue_id":"codex-orchestrator-2lg","depends_on_id":"codex-orchestrator-a1v","type":"blocks","created_at":"2025-12-17T13:23:29.049348-05:00","created_by":"daemon"}],"comments":[{"id":1,"issue_id":"codex-orchestrator-2lg","author":"samuelbrudner","text":"Reopening: reverting broad formatting; proceeding with minimal Ruff config + import-only fixes.","created_at":"2025-12-18T16:57:15Z"}]}
{"id":"codex-orchestrator-2ln","title":"Configure beads sync branch + prefix alignment","status":"closed","priority":2,"issue_type":"chore","owner":"samuel.brudner@gmail.com","created_at":"2026-01-28T21:57:52.081055-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-28T22:01:18.507682-05:00","closed_at":"2026-01-28T22:01:18.507682-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-3","title":"Run lifecycle \u0026 RUN_ID namespacing","description":"Implement the explicit run lifecycle: create/reuse a stable RUN_ID across repeated triggers (\"ticks\"), persist current_run.json with expiry, enforce a global run lock, namespace all artifacts by RUN_ID, and stop/close the run at end-of-window or after N ticks with no actionable work.","design":"Spec alignment:\n\n- A run corresponds to a single session (one run per night window for automated runs; one run per manual invocation).\n- RUN_ID is persisted across repeated ticks via cache/current_run.json (with expiry).\n- A global run lock prevents overlapping runs; new triggers during an active run exit loudly.\n- All artifacts are namespaced by RUN_ID (branches, decks, logs, reports, cache paths).\n- Run ends at end of the night window, or when no actionable beads remain for N ticks.\n- Run metadata records whether the run is automated (scheduler) or manual (roadtrip).","acceptance_criteria":"Given an initial trigger with no active run:\n\n- Orchestrator creates a new RUN_ID and persists it to cache/current_run.json.\n- Orchestrator creates a global run lock such that a second trigger during the active run exits loudly before doing any work.\n\nGiven subsequent triggers within the current_run.json expiry:\n\n- Orchestrator reuses the same RUN_ID (stable across ticks).\n- Artifact paths are deterministically namespaced by RUN_ID.\n\nWhen stop conditions are met (end-of-window for automated runs, or N ticks with no actionable work):\n\n- Orchestrator ends the run and releases the global run lock.\n- current_run.json is expired/cleared such that the next trigger starts a new run.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-14T11:40:15.440846-05:00","updated_at":"2025-12-15T10:56:50.753686-05:00","closed_at":"2025-12-15T10:56:50.753686-05:00"}
{"id":"codex-orchestrator-3k9","title":"Handle ambiguous base_branch checkout when multiple remotes define the branch","description":"autoencoded_vocal_analysis failed branch setup: base_branch=master with both origin/master and upstream/master present causes 'git checkout master' ambiguous error. Orchestrator should resolve ambiguous base_branch by preferring a configured default remote (e.g., origin), or using fully-qualified refs (origin/\u003cbranch\u003e) when multiple remotes provide the branch.","notes":"Renamed from codex-3k9 (original created_at 2026-01-22T20:31:42.08225-05:00)","status":"closed","priority":2,"issue_type":"bug","owner":"samuel.brudner@gmail.com","created_at":"2026-01-28T22:33:41.455421-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-06T14:26:43.198508-05:00","closed_at":"2026-02-06T14:26:43.198508-05:00","close_reason":"Completed","dependencies":[{"issue_id":"codex-orchestrator-3k9","depends_on_id":"codex-orchestrator-9","type":"discovered-from","created_at":"2026-01-28T22:33:41.456225-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-3og","title":"Add juvenile_learning_tda to home_projects inventory","status":"closed","priority":2,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-01-27T13:41:25.906626-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-27T13:43:09.434689-05:00","closed_at":"2026-01-27T13:43:09.434689-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-4","title":"Planning pass \u0026 immutable run decks","description":"Per-repo first-trigger planning pass: set Beads context, init bd, query ready issues, validate repo ingestion overlay, resolve per-bead execution contracts, detect notebook refactor candidates, record baseline validations, and snapshot an immutable run deck.","design":"Spec alignment:\n\n- Before any Beads operations for a repo, call beads.set_context(workspace_root=\u003crepo_path\u003e).\n\n- Planner operations (first trigger per repo per run):\n  1) bd init --quiet\n  2) bd ready --json\n  3) Validate repo ingestion overlay at config/bead_contracts/\u003crepo_id\u003e.toml:\n     - overlay must parse/validate\n     - overrides may only narrow allowed_roots and may not relax deny_roots\n     - overrides referencing unknown Beads IDs must fail loudly\n  4) Resolve each ready bead's execution contract deterministically from:\n     - repo policy from config/repos.toml\n     - overlay defaults ([defaults])\n     - per-bead overrides ([beads.\"\u003cBEAD_ID\u003e\"])\n     Resolution order: per-bead overrides \u003e [defaults] \u003e repo policy.\n  5) If any required contract field cannot be resolved for a ready bead, that bead is not queued; log loudly with the next action (edit the overlay file).\n  6) Detect modified/untracked notebooks under notebook_roots and create/tag notebook-refactor beads.\n  7) Record baseline validation status before work (declared validation_commands pass/fail).\n  8) Write immutable deck at \u003ccache\u003e/runs/\u003cRUN_ID\u003e/\u003crepo_id\u003e.deck.\u003cYYYY-MM-DD\u003e.json including:\n     - bead ID + title\n     - resolved contract snapshot used for execution\n     - baseline validation results\n\nNote: A repo is considered ingested only when its repo entry exists and its overlay validates.","acceptance_criteria":"Given a target repo with a config/repos.toml entry:\n\n- Planner validates config/bead_contracts/\u003crepo_id\u003e.toml; invalid overlays fail loudly with an actionable next step.\n- For each ready bead, the planner resolves a complete contract deterministically (per-bead overrides \u003e [defaults] \u003e repo policy).\n- Beads with missing/unresolvable required contract fields are excluded from the deck and produce loud actionable logs indicating what to add to the overlay.\n- The deck file is written at the specified cache path and includes the resolved contract snapshot per deck item plus baseline validation results.\n\nConservative replanning policy (v1):\n\n- Subsequent ticks reuse the frozen deck (no mid-run task drift).\n- Once a deck exists for (RUN_ID, repo_id), the planner does not recompute scope from bd ready, and does not add newly-created or newly-ready beads to the current run deck unless an explicit replanning mode is enabled.","notes":"Implemented the planning-pass + immutable run deck core:\n\n- Run deck schema v2 (`src/codex_orchestrator/planner.py`): deck items now include `contract` snapshot + `baseline_validation` results; `build_run_deck(...)` requires `baseline_results_by_command`.\n- Deck IO + reuse helpers:\n  - `read_run_deck(...)` / `load_existing_run_deck(...)` (`src/codex_orchestrator/planner.py`)\n  - `OrchestratorPaths.find_existing_run_deck_path(...)` (`src/codex_orchestrator/paths.py`)\n- Per-repo first-pass planner wrapper (`src/codex_orchestrator/planning_pass.py`): `ensure_repo_run_deck(...)` runs `bd init`, `bd list --json`, `bd ready --json`, validates overlay/contract resolution, runs baseline validations, and writes `\u003ccache\u003e/runs/\u003cRUN_ID\u003e/\u003crepo_id\u003e.deck.\u003cYYYY-MM-DD\u003e.json` atomically.\n- Conservative replanning policy (v1): `ensure_repo_run_deck(replan=False)` reuses an existing deck for (RUN_ID, repo_id) and does not call bd/validations; `replan=True` is the explicit escape hatch.\n- Support modules:\n  - `src/codex_orchestrator/bd_cli.py` (bd subprocess wrapper + parsing)\n  - `src/codex_orchestrator/validation_runner.py` (baseline validation command runner)\n  - `ResolvedExecutionContract.from_json_dict(...)` (`src/codex_orchestrator/contracts.py`) for execution-time deck loading.\n- Tests updated/added: `tests/test_planner_gating.py`, `tests/test_planning_pass_reuse.py`.\n\nLocal validation: `python3 -m compileall -q src tests` (pytest not available in this environment).","status":"closed","priority":1,"issue_type":"epic","assignee":"codex","created_at":"2025-12-14T11:40:22.000203-05:00","updated_at":"2025-12-15T13:00:23.093737-05:00","closed_at":"2025-12-15T13:00:23.093737-05:00","dependencies":[{"issue_id":"codex-orchestrator-4","depends_on_id":"codex-orchestrator-3","type":"blocks","created_at":"2025-12-15T00:23:08.919851-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-4","depends_on_id":"codex-orchestrator-16","type":"blocks","created_at":"2025-12-15T00:23:08.990531-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-41v","title":"a33: Refactor planning_audit LOC compliance (part 1)","description":"Refactor src/codex_orchestrator/planning_audit.py to comply with \u003c=15 LOC per function rule (src/), without behavior changes. Focus on build/assemble/base helpers that are still \u003e15 LOC and remove any now-unused imports introduced during refactors.","acceptance_criteria":"- AST LOC check shows build_planning_audit, _assemble_audit, _audit_base are all \u003c=15 LOC\n- ruff passes on touched files\n- existing planning-audit-related tests still pass","status":"closed","priority":2,"issue_type":"task","assignee":"gpt-5.2","created_at":"2025-12-19T10:28:05.856332-05:00","updated_at":"2025-12-19T11:29:55.729092-05:00","closed_at":"2025-12-19T11:29:55.729092-05:00","close_reason":"Closed via update"}
{"id":"codex-orchestrator-4hb","title":"Add review cadence to end runs after N beads","description":"Allow configuring a review cadence so runs end after a configurable number of beads attempted, forcing human signoff before continuing.","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-01-29T19:34:59.573084-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-29T19:36:37.749277-05:00","closed_at":"2026-01-29T19:36:37.749277-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-4ou","title":"Add autoencoded-vocal-analysis repo config + contract overlay","description":"Add config/repos.toml entry and config/bead_contracts/autoencoded_vocal_analysis.toml (env=ava, allow_env_creation=true, pytest validation) so orchestrator can run against /Users/samuelbrudner/CascadeProjects/autoencoded-vocal-analysis.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T22:22:57.070254-05:00","updated_at":"2026-01-13T22:27:35.023449-05:00","closed_at":"2026-01-13T22:27:35.023449-05:00","close_reason":"Added autoencoded_vocal_analysis repo entry and contract overlay with env=ava, allow_env_creation=true, pytest validation."}
{"id":"codex-orchestrator-4oy","title":"Decompose beads when diff cap exceeded","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-01-30T21:06:48.997259-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-30T21:18:53.459579-05:00","closed_at":"2026-01-30T21:18:53.459579-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-5","title":"DEPRECATED: Per-repo execution engine (superseded by codex-orchestrator-10)","description":"Execute work units for a repo within a run: lock repo, work through deck items, invoke , update bd issue states, and time-bound progress.","acceptance_criteria":"Execution is serialized per repo with filesystem locks; bd issues transition in_progress→closed with notes; codex invocations are captured in logs; work respects time budgets.","notes":"This issue was closed but overlaps with codex-orchestrator-10. Treat codex-orchestrator-10 as the active epic for the per-repo execution engine per project_spec.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-14T11:40:24.024182-05:00","updated_at":"2025-12-14T13:32:49.698789-05:00","closed_at":"2025-12-14T12:09:48.710633-05:00"}
{"id":"codex-orchestrator-5qh","title":"Avoid hard-fail on git fetch errors during repo setup","description":"Git fetch failures (e.g., FETCH_HEAD permission errors or missing network) currently skip the repo and lead to idle-tick run termination. Treat fetch as best-effort: warn and proceed with local state.","status":"closed","priority":1,"issue_type":"bug","owner":"samuel.brudner@gmail.com","created_at":"2026-02-02T10:10:07.16968-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-02T10:12:32.129574-05:00","closed_at":"2026-02-02T10:12:32.129574-05:00","close_reason":"Done"}
{"id":"codex-orchestrator-6","title":"Scheduling window \u0026 roadtrip mode CLI","description":"Implement scheduling controls: night-window gating (default 20:00–07:00 local time) for scheduler-triggered runs, a default 45-minute cadence (configurable), and a manual roadtrip CLI that runs the same lifecycle repeatedly under a shared RUN_ID.","design":"Spec alignment:\n\n- Default automated night window is 20:00–07:00 local time.\n- Outside this window, scheduler-triggered (automated) runs do not start and exit immediately before doing any work.\n- Manual/roadtrip runs are not subject to the window gate, and runs already in progress are never aborted when the window closes.\n- Cadence defaults to every 45 minutes; configurable for both automated and manual modes.\n- Roadtrip CLI runs repeated execution cycles under a shared RUN_ID and performs an immediate planning pass.","acceptance_criteria":"Outside the configured night window, scheduler-triggered runs exit immediately before any repo work begins. Inside the window, automated scheduling triggers at the configured cadence (default 45 minutes).\n\nThe roadtrip CLI supports invocations like:\n\n- codex-roadtrip --hours 3\n- codex-roadtrip --until \"YYYY-MM-DD HH:MM\"\n\nRoadtrip runs reuse a shared RUN_ID across cycles and follow the same lifecycle, safety, and branching rules as automated runs.","notes":"Completed scheduling window + roadtrip CLI.\n\n- Night-window gate (20:00–07:00 local): automated runs outside window skip immediately with no repo work (`tick_run` + `ensure_active_run`). Added test coverage.\n- New scheduler entrypoint: `codex-orchestrator run` executes one full cycle across all selected repos under the global run lock; defaults tick budget to 45 minutes; supports `--max-parallel` (or `$MAX_PARALLEL`), repo selection (`--repo-id/--repo-group`), and passes through per-tick safety caps.\n- New manual roadtrip tool: `codex-roadtrip --hours N` / `codex-roadtrip --until \"YYYY-MM-DD HH:MM\"` runs repeated manual cycles at configurable cadence (default 45m) under a shared RUN_ID and ends the manual run on exit.\n\nFiles: `src/codex_orchestrator/run_lifecycle.py`, `src/codex_orchestrator/orchestrator_cycle.py`, `src/codex_orchestrator/cli.py`, `src/codex_orchestrator/roadtrip_cli.py`, `pyproject.toml`, `tests/test_run_lifecycle.py`, `tests/test_cli_smoke.py`.\nTests: `conda run -n codex-orchestrator python -m pytest` (31 passed).\n\nCommit: 3f3adc7","status":"closed","priority":2,"issue_type":"epic","assignee":"codex","created_at":"2025-12-14T11:40:26.368114-05:00","updated_at":"2025-12-15T21:52:49.73324-05:00","closed_at":"2025-12-15T21:47:20.53251-05:00","dependencies":[{"issue_id":"codex-orchestrator-6","depends_on_id":"codex-orchestrator-3","type":"blocks","created_at":"2025-12-15T07:03:06.148457-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-6td","title":"Document repo onboarding prerequisites and defaults generated by init command","status":"closed","priority":2,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-02-06T14:08:00.157963-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-06T14:08:25.100381-05:00","closed_at":"2026-02-06T14:08:25.100381-05:00","close_reason":"Created accidentally during tooling flow","dependencies":[{"issue_id":"codex-orchestrator-6td","depends_on_id":"codex-orchestrator-3k9","type":"discovered-from","created_at":"2026-02-06T14:08:00.160077-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-7","title":"Audit trail: run reports + structured logs","description":"Produce reviewable run artifacts: per-repo markdown run reports and structured logs, plus orchestrator-side summaries and a one-command status view for quick inspection.","design":"Spec alignment:\n\n- Each repo produces a markdown run report at docs/runs/\u003cRUN_ID\u003e.md with required fields.\n- Orchestrator stores global run logs, per-repo stdout/stderr logs, and cache-side summaries in deterministic locations.\n- Provide a one-command status summary: codex-status --run-id \u003cRUN_ID\u003e.","acceptance_criteria":"For each repo worked in a run, a report is written to docs/runs/\u003cRUN_ID\u003e.md containing:\n\n- Summary\n- RUN_ID and branch name (run/\u003cRUN_ID\u003e)\n- Beads issues worked (IDs + titles)\n- Notebook refactors (notebooks + extracted code locations)\n- Tests/commands executed (declared validation_commands)\n- Failures or skipped steps (with next action)\n- Follow-ups (including downstream bead updates)\n- Tool versions (bd, codex, git, python/conda)\n\nOrchestrator also records deterministic global/per-repo logs (stdout/stderr) and cache-side summaries, and codex-status --run-id \u003cRUN_ID\u003e prints a concise status view including failure triage (one line per repo with the next action).","notes":"Claimed by Codex CLI to implement run audit artifacts (per-repo markdown reports, structured logs, and `codex-status`).\n\nImplemented audit trail + status view:\n\n- Repo-local run reports: `docs/runs/\u003cRUN_ID\u003e.md` written by `execute_repo_tick(...)` (and committed when safe), with required sections (summary, run metadata, beads, notebook refactors, validation commands, failures/next action, follow-ups, tool versions).\n- Deterministic cache-side artifacts per repo under `\u003ccache\u003e/runs/\u003cRUN_ID\u003e/`:\n  - Global: `orchestrator.log`, `run_summary.json`\n  - Per repo: `\u003crepo_id\u003e.exec.log`, `\u003crepo_id\u003e.stdout.log`, `\u003crepo_id\u003e.stderr.log`, `\u003crepo_id\u003e.events.jsonl`, `\u003crepo_id\u003e.summary.json`\n- One-command status: added `codex-status --run-id \u003cRUN_ID\u003e` (and `--json`) to summarize each repo with `next_action`.\n\nImplementation notes:\n- Report write respects repo safety boundaries (`RepoPolicy.allowed_roots`/`deny_roots`); if `docs/runs/` is outside policy it is skipped and recorded in repo summary + events.\n- Tests: `conda run -n codex-orchestrator python -m pytest` passes (24 tests).\n\nCommit: 15c913b","status":"closed","priority":1,"issue_type":"epic","assignee":"codex","created_at":"2025-12-14T11:40:27.957843-05:00","updated_at":"2025-12-15T15:09:43.969614-05:00","closed_at":"2025-12-15T15:06:13.017281-05:00"}
{"id":"codex-orchestrator-79z","title":"Run closure: final-session review + deterministic run report","description":"Add a first-class \"final session\" phase when a run ends. When the orchestrator decides to end a run (window_end / idle_ticks / explicit end), it should switch to a reviewer/closer behavior that summarizes what happened, evaluates outcomes against intended scope, and writes a deterministic run-closure report artifact.\n\nThis is analogous to the first-session planning/designer status, but for run termination.\n\nKey idea: prefer deterministic review artifacts derived from existing per-repo summaries/events/decks; optionally support a Codex \"review-only\" pass behind a flag that must produce zero diffs (enforced).","design":"Implementation sketch:\n\n- Add a new module (e.g. `run_closure_review.py`) that can build `FinalReview` from:\n  - run_end.json\n  - per-repo repo_summary.json\n  - run metadata\n  - events.jsonl (optional)\n  - run deck files (read-only)\n\n- Trigger it in `orchestrator_cycle.run_orchestrator_cycle(...)` when `tick_result` indicates `ended=True` (or via `end_current_run`).\n\n- Write artifacts using existing atomic write helper(s) (or factor out).\n\n- Keep it non-destructive by default; Codex review-only pass should be explicitly enabled in config and enforced by git diff check.","acceptance_criteria":"1) Deterministic closure artifacts\n- When a run ends, orchestrator writes:\n  - `\u003ccache\u003e/runs/\u003cRUN_ID\u003e/final_review.json`\n  - `\u003ccache\u003e/runs/\u003cRUN_ID\u003e/final_review.md` (optional but preferred)\n- Artifacts are deterministic: stable ordering, no nondeterministic content in findings sections.\n\n2) Evaluation vs intended work\n- For each repo in the run, the report includes:\n  - deck path and whether it was reused\n  - planned bead IDs (from run deck)\n  - beads attempted/closed/skipped + reasons (from repo summaries)\n  - whether any new beads were created during the run (if detectable) and an explicit statement that they were NOT added to the current run deck (conservative replanning)\n\n3) Policy + safety summary\n- Report includes:\n  - AI policy settings used (model + reasoning effort) and the effective Codex argv/command\n  - git safety outcomes / skip reasons\n  - validation commands + statuses\n\n4) Hooking point\n- The closure report is generated exactly once per run end and is referenced from the existing run-level summary (or a clear pointer exists).\n\n5) Optional: review-only Codex pass (behind flag)\n- If enabled, orchestrator may run a final Codex \"review-only\" step.\n- Enforcement: if the step produces any git diff, the orchestrator fails loudly and does not accept the changes.\n\n6) Tests\n- Unit/integration tests cover:\n  - generating final_review artifacts on end-of-run\n  - determinism (stable ordering) for a fixed synthetic run directory\n  - review-only Codex enforcement if implemented (diff must be empty)","notes":"Committed: fedc8fa1c1f079b949d7375b36b5aa4fb6d1c408","status":"closed","priority":2,"issue_type":"feature","assignee":"codex","created_at":"2025-12-15T21:49:28.216051-05:00","updated_at":"2025-12-16T09:36:53.155724-05:00","closed_at":"2025-12-15T22:22:45.885796-05:00","labels":["reporting","run_lifecycle"]}
{"id":"codex-orchestrator-7us","title":"Conservative replanning policy (v1): reuse frozen deck; no mid-run scope changes by default","description":"Implement the conservative replanning policy for v1 runs: once a per-repo deck exists for (RUN_ID, repo_id), subsequent ticks must reuse it and must not add newly-created or newly-ready Beads to the current run scope unless explicitly enabled. Execution should still gate work based on current Beads status (closed/blocked =\u003e skip with recorded reason).","acceptance_criteria":"Given a run with an existing deck for (RUN_ID, repo_id):\n\n- Planner does not call bd ready to recompute scope.\n- Planner does not modify the existing deck contents.\n- Execution iterates deck items and skips any whose bead is closed or blocked, recording the reason.\n- If new Beads issues are created in the target repo during the run (including audit-created issues), they are not added to the current run deck.\n\nAn explicit configuration flag (or CLI option) exists to enable replanning in a future mode, but defaults to disabled.","notes":"Implemented conservative replanning policy for v1 runs:\n\n- Deck is frozen per (RUN_ID, repo_id): `ensure_repo_run_deck(..., replan=False)` reuses the existing deck and does not call `bd ready` / `bd list` / validations or rewrite the deck.\n- Added explicit replanning switch (defaults disabled): `RepoExecutionConfig.replan` + CLI `codex-orchestrator exec-repo --replan`.\n- `execute_repo_tick(...)` passes `config.replan` through to `ensure_repo_run_deck(...)` and includes `replan` in emitted planning events.\n- Execution gates frozen deck items by live bd status: `closed`/`blocked` are skipped with recorded reasons.\n\nFiles: `src/codex_orchestrator/planning_pass.py`, `src/codex_orchestrator/repo_execution.py`, `src/codex_orchestrator/cli.py`.\nTests: `conda run -n codex-orchestrator python -m pytest` (27 passed).\n\nCommit: 241a3c8","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2025-12-15T09:40:10.820865-05:00","updated_at":"2025-12-15T16:04:47.992456-05:00","closed_at":"2025-12-15T16:03:25.374435-05:00"}
{"id":"codex-orchestrator-8","title":"Concurrency controls \u0026 per-repo locking","description":"Support parallelism across repos (MAX_PARALLEL) while enforcing strict serialization within each repo via filesystem locks; optionally enforce per-repo timeouts.","acceptance_criteria":"Multiple repos can run concurrently up to MAX_PARALLEL; attempts to run the same repo concurrently are prevented via locks; timeouts abort repo work cleanly with recorded reasons.","notes":"Implemented per-repo filesystem locks + basic multi-repo concurrency:\n\n- `OrchestratorPaths.repo_lock_path(...)` + `repo_locks_dir` (`src/codex_orchestrator/paths.py`).\n- `RunLock` includes an in-process guard to prevent same-process double-acquire (`src/codex_orchestrator/run_lock.py`).\n- `execute_repo_tick(...)` wraps repo work in a per-repo lock; `execute_repos_tick(...)` runs multiple repos concurrently via `ThreadPoolExecutor(max_workers=max_parallel)` (`src/codex_orchestrator/repo_execution.py`).\n\nImplementation commit: 614ccb8 (beads(codex-orchestrator-10): per-repo execution engine)\nTests: conda run -n codex-orchestrator python -m pytest (23 passed)","status":"closed","priority":2,"issue_type":"epic","assignee":"codex","created_at":"2025-12-14T11:40:29.664226-05:00","updated_at":"2025-12-15T14:09:42.861873-05:00","closed_at":"2025-12-15T13:45:07.908509-05:00","comments":[{"id":2,"issue_id":"codex-orchestrator-8","author":"samuelbrudner","text":"Note: Dirty-tree after bd updates interacts with concurrency: a dirty working tree will cause later ticks to skip the repo and can also cause cross-bead contamination if multiple beads run in the same tick. Ensure repo-level locks + clean-tree invariants cover bd metadata updates as well.","created_at":"2025-12-17T03:59:03Z"}]}
{"id":"codex-orchestrator-8pb","title":"Run validations inside repo environment (conda/uv)","description":"Contracts include `env` / `allow_env_creation`, but validations currently run in the ambient environment.\n\nFor multi-repo unattended runs, validations must run in the repo’s declared environment deterministically (e.g., `conda run -n \u003cenv\u003e ...` or `uv run ...`).\n\nThis interacts with the validation allowlist: we should keep validation commands simple (e.g., `pytest -q`) and have the orchestrator wrap them in the environment runner.","acceptance_criteria":"- Repo validations are executed in the declared environment for that repo.\n- Contract/config specifies which runner to use (conda vs uv) or a single standard is chosen.\n- Safety allowlist remains strict; wrapping happens in orchestrator code.\n- Tests cover env wrapping for at least one runner (using stub runner on PATH).","notes":"Implemented conda-based env wrapping for repo validations.\n\n- `run_validation_commands(..., env=...)` now executes validations via `conda run -n \u003cenv\u003e ...` (shell-free argv execution).\n- Planning baseline validations (`ensure_repo_run_deck`) now run in the repo’s resolved env (repo policy env, else first planned contract env).\n- Execution-time validations (`execute_repo_tick`) now run in each bead’s contract env.\n- Tests: added fake `conda` runner stubs and assertions so CI doesn’t require real conda envs; verifies `conda run -n test ...` is invoked.\n\nLocal validation: `conda run -n codex-orchestrator python -m pytest -q`","status":"closed","priority":1,"issue_type":"feature","assignee":"codex","created_at":"2025-12-16T22:59:03.098893-05:00","updated_at":"2025-12-16T23:41:16.468914-05:00","closed_at":"2025-12-16T23:41:16.468914-05:00","dependencies":[{"issue_id":"codex-orchestrator-8pb","depends_on_id":"codex-orchestrator-10","type":"discovered-from","created_at":"2025-12-16T22:59:03.100755-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-9","title":"Git safety checks \u0026 branch-first workflow","description":"Implement per-repo safety checks and branch-first workflow: enforce required tool availability, skip unsafe repo states, create run/\u003cRUN_ID\u003e branches from explicit base branches, and never merge or push by default.","design":"Spec alignment:\n\n- Fail loud, skip safely:\n  - Missing tools (codex, bd) =\u003e hard failure.\n  - Dirty working tree =\u003e repo skipped.\n  - Detached HEAD =\u003e repo skipped.\n- Branch-first safety model:\n  - Create a fresh branch per repo per run: run/\u003cRUN_ID\u003e.\n  - Branch is created from an explicit base_branch declared in config (never inferred).\n  - Sync policy before branching: git fetch only (no pull/rebase).\n  - Orchestrator never merges and does not push by default.","acceptance_criteria":"Repos with missing required tools cause the run to fail loudly before doing any work.\n\nFor each target repo:\n\n- If the working tree is dirty or HEAD is detached, the repo is skipped with a clear, recorded reason.\n- Otherwise, the orchestrator creates (or checks out) run/\u003cRUN_ID\u003e from the configured base_branch that existed before the run.\n- The orchestrator performs git fetch only prior to branching (no pull/rebase).\n- The orchestrator never merges branches, and push is disabled by default.","notes":"Implemented git safety + branch-first workflow for per-repo execution:\n\n- Git subprocess wrappers in `src/codex_orchestrator/git_subprocess.py`.\n- `execute_repo_tick(...)` enforces clean tree + non-detached HEAD, does `git fetch` when remotes exist, then checks out or creates `run/\u003cRUN_ID\u003e` from the configured `base_branch` (`src/codex_orchestrator/repo_execution.py`).\n- Orchestrator never merges/pushes; rejects codex-created commits and owns staging/commits.\n- CLI entrypoint: `codex-orchestrator exec-repo --repo-id ...` (`src/codex_orchestrator/cli.py`).\n\nImplementation commit: 614ccb8 (beads(codex-orchestrator-10): per-repo execution engine)\nTests: conda run -n codex-orchestrator python -m pytest (23 passed)","status":"closed","priority":1,"issue_type":"epic","assignee":"codex","created_at":"2025-12-14T11:46:02.606038-05:00","updated_at":"2025-12-15T14:09:43.463382-05:00","closed_at":"2025-12-15T13:45:07.918567-05:00","dependencies":[{"issue_id":"codex-orchestrator-9","depends_on_id":"codex-orchestrator-2","type":"blocks","created_at":"2025-12-15T07:03:06.217364-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-9","depends_on_id":"codex-orchestrator-3","type":"blocks","created_at":"2025-12-15T07:03:06.288174-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-9qv","title":"Planning audit: optionally create/tag Beads issues in target repo","description":"Add optional capability for the orchestrator planning audit to create/tag Beads issues in the *target repo* for top actionable findings, without changing current run-deck scope.","acceptance_criteria":"- Feature is off by default; when enabled via config, planner:\n  - creates up to N issues (configurable) in the target repo\n  - links them as discovered-from the run context (include RUN_ID and audit artifact paths in notes)\n  - does NOT automatically add them to the current run deck\n- Behavior is deterministic (same findings =\u003e same issue titles/contents where feasible).\n- If Beads tooling missing/unavailable, behavior is fail-loud or explicitly recorded as skipped per policy.\n- Tests cover: disabled mode (no issues), enabled mode (issues created), tooling failure.","notes":"Implemented optional creation of Beads issues in target repo from planning audit findings (gated by per-repo overlay defaults).\n\nCommits:\n- 92db279 (feat(planning-audit): optionally create beads issues)\n\nNotes:\n- Overlay keys: enable_planning_audit_issue_creation, planning_audit_issue_limit\n- Records created issues in planning audit JSON under created_issues\n\nTests:\n- uv run --extra dev -m pytest -q tests/test_planning_audit_issues.py tests/test_planning_pass_reuse.py","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-16T21:44:27.999184-05:00","updated_at":"2025-12-16T22:42:03.124049-05:00","closed_at":"2025-12-16T22:42:03.124049-05:00","dependencies":[{"issue_id":"codex-orchestrator-9qv","depends_on_id":"codex-orchestrator-n19","type":"discovered-from","created_at":"2025-12-16T21:44:28.001138-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-9uy","title":"Model \u0026 AI configuration policy enforcement","description":"Centralize and enforce unattended run model policy: require gpt-5.2 with reasoning effort xhigh and codex exec --full-auto, refuse to run on mismatch, and record applied settings for auditability.","design":"Spec alignment:\n\n- All unattended runs must use:\n  - Model: gpt-5.2\n  - Reasoning effort: xhigh\n  - Execution mode: codex exec --full-auto (no interactive prompts)\n- Model and reasoning settings are centralized in orchestrator configuration and asserted by the CLI.\n- Unattended runs refuse to run if configured model or reasoning effort does not match policy.\n- Tool/version info is recorded in run reports for reproducibility.","acceptance_criteria":"If the orchestrator is configured with a model or reasoning effort that does not match policy, unattended runs refuse to start with a loud, actionable error before doing any repo work.\n\nWhen policy is satisfied, codex invocations use codex exec --full-auto and the configured model/reasoning settings.\n\nThe effective model/reasoning settings (and tool versions where applicable) are recorded in run artifacts so a reviewer can verify policy compliance after the run.","notes":"Completed model/AI policy enforcement + audit recording.\n\n- Added enforced AI config file: `config/orchestrator.toml` ([ai] model=gpt-5.2, reasoning_effort=xhigh).\n- Centralized policy loader/enforcer + codex arg builder: `src/codex_orchestrator/ai_policy.py`.\n- CLI asserts policy and refuses to start on mismatch (before repo work): [src/codex_orchestrator/cli.py](cci:7://file:///Users/samuelbrudner/dev/codex-orchestrator/src/codex_orchestrator/cli.py:0:0-0:0).\n- Codex invocations explicitly pass model + reasoning and remain full-auto: [src/codex_orchestrator/repo_execution.py](cci:7://file:///Users/samuelbrudner/dev/codex-orchestrator/src/codex_orchestrator/repo_execution.py:0:0-0:0) (`--model gpt-5.2`, `-c reasoning_effort=\"xhigh\"`).\n- Run artifacts record effective settings; repo run report includes an “AI Configuration” section (`src/codex_orchestrator/audit_trail.py`).\n\nTests: `conda run -n codex-orchestrator python -m pytest` (29 passed).\n\nCommit: 619f2d3","status":"closed","priority":1,"issue_type":"epic","assignee":"codex","created_at":"2025-12-14T13:32:49.78633-05:00","updated_at":"2025-12-15T21:20:28.178549-05:00","closed_at":"2025-12-15T16:24:56.479849-05:00"}
{"id":"codex-orchestrator-a1v","title":"Tests: run signoff gate + CLI","description":"Add unit tests to cover: new-run blocked if latest ended run lacks signoff; new-run allowed after signoff; signoff CLI writes artifacts and validation ties to final_review sha.","acceptance_criteria":"- Tests cover blocked start without signoff.\\n- Tests cover allowed start after signoff.\\n- Tests cover CLI signoff artifact creation and sha mismatch failure.","notes":"Context from `codex-orchestrator-dee`:\n\n- Implemented signoff gate in `src/codex_orchestrator/run_lifecycle.py` via `_require_latest_ended_run_signed_off()`.\n  - Called in both new-run entrypoints: `tick_run` and `ensure_active_run` (right before generating a new RUN_ID).\n  - Gate logic: `find_latest_ended_run_id(paths)` -\u003e `validate_run_signoff(paths, run_id=latest)`; blocks with a `RunLifecycleError` that includes `final_review` path + `codex-orchestrator signoff --run-id ... --reviewer \u003cname\u003e`.\n\n- Added tests in `tests/test_run_signoff_gate.py`:\n  - New-run blocked (tick + ensure) when latest ended run lacks signoff.\n  - New-run allowed after `write_run_signoff(...)`.\n\nUpdate from `codex-orchestrator-k5f`:\n\n- CLI: added `codex-orchestrator signoff` in `src/codex_orchestrator/cli.py` (`_cmd_signoff`).\n  - Args: `--run-id` (defaults to latest ended via `find_latest_ended_run_id(paths)`), `--cache-dir`, `--reviewer` (or env `$CODEX_ORCHESTRATOR_REVIEWER`), `--notes`.\n  - Behavior: calls `write_run_signoff(...)` then `validate_run_signoff(...)`; exits nonzero with `SystemExit(\"codex-orchestrator: ...\")` on `RunSignoffError` (missing `run_end.json`, cannot generate final review, sha mismatch, etc.).\n  - Success output includes:\n    - `RUN_ID=\u003cid\u003e status=ok`\n    - `json_path=.../run_signoff.json` and `md_path=.../run_signoff.md`\n    - `reviewer=...` and `reviewed_at=...`\n\n- For CLI tests: creating only `run_end.json` under `cache_dir/runs/\u003cRUN_ID\u003e/` is sufficient; `final_review.json/md` will be auto-generated if missing.\n\nCompleted in `codex-orchestrator-a1v`:\n\n- Added CLI + validation tests in `tests/test_run_signoff_cli.py`:\n  - CLI `signoff` writes `run_signoff.json`/`run_signoff.md` and auto-generates `final_review.json`/`final_review.md`.\n  - `validate_run_signoff` fails loud on final_review sha256 mismatch.\n- Verified:\n  - `conda run -n codex-orchestrator python -m pytest -q tests/test_run_signoff_gate.py tests/test_run_signoff_cli.py`\n  - `conda run -n codex-orchestrator ruff check tests/test_run_signoff_cli.py tests/test_run_signoff_gate.py` (passes).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:00.33001-05:00","updated_at":"2025-12-18T10:46:49.766461-05:00","closed_at":"2025-12-18T10:46:49.766461-05:00","close_reason":"Added CLI signoff + sha-mismatch tests and verified via conda pytest/ruff.","dependencies":[{"issue_id":"codex-orchestrator-a1v","depends_on_id":"codex-orchestrator-dee","type":"blocks","created_at":"2025-12-17T13:23:28.742649-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-a1v","depends_on_id":"codex-orchestrator-k5f","type":"blocks","created_at":"2025-12-17T13:23:28.903966-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-a33","title":"Planning audit: harden edge cases + fail-loud policy","description":"Harden planning-audit generation so it behaves predictably on real-world repos (large trees, binary-heavy, permission errors, etc.) while staying consistent with the repo’s fail-loud philosophy.","acceptance_criteria":"- Planning audit step has explicit, test-covered behavior for:\n  - unreadable paths / permission errors\n  - binary-only repos / no text files\n  - very large repos (bounded inventory / bounded runtime)\n- Any skipped/partial results are recorded explicitly in the audit artifact with reason + suggested next action.\n- Unexpected errors fail loudly (no silent fallbacks) and do not write partial run-deck artifacts.","status":"closed","priority":2,"issue_type":"feature","assignee":"gpt-5.2","created_at":"2025-12-16T21:44:27.57118-05:00","updated_at":"2025-12-19T14:07:44.511808-05:00","closed_at":"2025-12-19T14:07:44.511808-05:00","close_reason":"Closed via update","dependencies":[{"issue_id":"codex-orchestrator-a33","depends_on_id":"codex-orchestrator-n19","type":"discovered-from","created_at":"2025-12-16T21:44:27.57318-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-a33","depends_on_id":"codex-orchestrator-41v","type":"parent-child","created_at":"2025-12-19T10:28:50.69139-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-a33","depends_on_id":"codex-orchestrator-btp","type":"parent-child","created_at":"2025-12-19T10:28:51.157452-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-a33","depends_on_id":"codex-orchestrator-thx","type":"parent-child","created_at":"2025-12-19T10:28:51.821249-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-agc","title":"Trigger Codex review cadence without ending runs","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-01-29T19:46:03.408885-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-29T19:50:15.609383-05:00","closed_at":"2026-01-29T19:50:15.609383-05:00","close_reason":"Completed","dependencies":[{"issue_id":"codex-orchestrator-agc","depends_on_id":"codex-orchestrator-4hb","type":"discovered-from","created_at":"2026-01-29T19:46:03.410371-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-btp","title":"a33: Refactor planning_audit scan/status/findings LOC compliance (part 2)","description":"Refactor remaining oversized planning_audit functions (_scan_semantic_signals, _audit_status, _build_findings, _collect_repo_files, _iter_files_under_root, _read_text_limited_with_status) to \u003c=15 LOC per src standards, preserving behavior and fail-loud intent.","acceptance_criteria":"- AST LOC check shows all functions in src/codex_orchestrator/planning_audit.py are \u003c=15 LOC\n- No behavior changes to audit JSON/MD structure beyond refactor\n- ruff passes and planning-audit tests pass","notes":"Starting LOC refactor part 2: remaining oversized functions in planning_audit.py (scan/status/findings + file collection/read helpers), preserving fail-loud behavior and current tests.","status":"closed","priority":2,"issue_type":"task","assignee":"gpt-5.2","created_at":"2025-12-19T10:28:11.223904-05:00","updated_at":"2025-12-19T14:04:38.883916-05:00","closed_at":"2025-12-19T14:04:38.883916-05:00","close_reason":"Closed via update"}
{"id":"codex-orchestrator-cir","title":"Validation env fidelity: enforce and preflight conda env health","description":"Ensure all validation and diagnostics are executed in the contract env; add preflight checks to catch broken torch/numpy envs before repeated retries.","status":"open","priority":1,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-02-07T18:56:09.141551-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-07T18:56:09.141551-05:00","dependencies":[{"issue_id":"codex-orchestrator-cir","depends_on_id":"codex-orchestrator-n9x","type":"discovered-from","created_at":"2026-02-07T18:56:09.142736-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-cn8","title":"Fix python -m codex_orchestrator.cli module entrypoint","status":"closed","priority":1,"issue_type":"bug","owner":"samuel.brudner@gmail.com","created_at":"2026-02-07T15:49:49.791803-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-07T16:05:57.024227-05:00","closed_at":"2026-02-07T16:05:57.024227-05:00","close_reason":"Fixed module entrypoint and added CLI coverage","dependencies":[{"issue_id":"codex-orchestrator-cn8","depends_on_id":"codex-orchestrator-d8q","type":"discovered-from","created_at":"2026-02-07T15:49:49.793265-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-cq9","title":"Bound validation timeouts, init transactional behavior, and safer default parallelism","status":"closed","priority":1,"issue_type":"bug","owner":"samuel.brudner@gmail.com","created_at":"2026-02-06T14:21:28.964883-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-06T14:26:43.19851-05:00","closed_at":"2026-02-06T14:26:43.19851-05:00","close_reason":"Completed","dependencies":[{"issue_id":"codex-orchestrator-cq9","depends_on_id":"codex-orchestrator-3k9","type":"discovered-from","created_at":"2026-02-06T14:21:28.966316-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-crg","title":"Recovery: auto-close stale current_run after process death","description":"When run lock PID is dead, auto-recover run state by writing run_end.json with a crash-recovery reason and releasing stale locks safely.","status":"open","priority":1,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-02-07T18:56:29.521336-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-07T18:56:29.521336-05:00","dependencies":[{"issue_id":"codex-orchestrator-crg","depends_on_id":"codex-orchestrator-n9x","type":"discovered-from","created_at":"2026-02-07T18:56:29.522562-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-d8q","title":"Gate new runs on human sign-off of final review","description":"Prevent unattended drift by requiring a human to review/sign off the previous run’s final review before any new run can start.","acceptance_criteria":"- When starting a new run (no active current_run.json), the orchestrator refuses to create a new RUN_ID if the most recent ended run lacks a valid signoff artifact.\\n- Provide a CLI command to create the signoff artifact for a given RUN_ID (or latest ended run), capturing reviewer identity and timestamp and tying signoff to the final review artifacts.\\n- Fail loudly with an actionable error message that points to the final review and the signoff command.\\n- Unit tests cover: blocked start without signoff; allowed start after signoff; signoff artifact validation.","notes":"Update from `codex-orchestrator-2lg` (final):\n\n- `ruff check .` is clean with minimal changes:\n  - `pyproject.toml`: `line-length = 160` (avoids repo-wide E501 reflow).\n  - Import-only fixes (`I001` ordering, `UP035` collections.abc typing imports).\n- No mypy config/dep found in this repo environment; ran `.venv/bin/python -m compileall -q src tests` as sanity check.\n- `pytest` passes; when invoking via `.venv/bin/python -m pytest`, ensure `PATH` includes `.venv/bin` so subprocess validations that call `pytest -q` resolve.\n","status":"in_progress","priority":1,"issue_type":"feature","created_at":"2025-12-17T12:11:51.868226-05:00","updated_at":"2025-12-18T12:00:45.14126-05:00","dependencies":[{"issue_id":"codex-orchestrator-d8q","depends_on_id":"codex-orchestrator-2lg","type":"blocks","created_at":"2025-12-17T13:25:32.832048-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-dee","title":"Run lifecycle gate: require prior run signoff before starting new run","description":"In run_lifecycle.ensure_active_run (and any other new-run entrypoint), if no active run exists and a new RUN_ID would be created, block unless the most recent ended run has a valid run_signoff.json matching final_review.json sha256. Error must be fail-loud and actionable (point to final review + signoff command).","acceptance_criteria":"- Starting a new run when the latest ended run lacks signoff fails with a clear error pointing to the final review and signoff command.\\n- Starting a new run after signoff succeeds.","notes":"Upstream `codex-orchestrator-l51` added run signoff helpers in `src/codex_orchestrator/run_signoff.py`.\n\n- Latest-ended-run: `find_latest_ended_run_id(paths)`\n- Gate check: `validate_run_signoff(paths, run_id=...)` (raises `RunSignoffError` on missing `run_signoff.*` / `final_review.*`, JSON parse/schema errors, RUN_ID mismatch, or sha256 mismatch vs `final_review.json`).\n- Artifact paths are available via `OrchestratorPaths`: `run_signoff_{json,md}_path(...)` and `final_review_{json,md}_path(...)`.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2025-12-17T13:18:40.61706-05:00","updated_at":"2025-12-17T14:18:02.518154-05:00","closed_at":"2025-12-17T14:18:02.518154-05:00","close_reason":"Implemented latest-ended-run signoff gate in run_lifecycle (tick_run + ensure_active_run) and added tests covering block/allow behavior.","dependencies":[{"issue_id":"codex-orchestrator-dee","depends_on_id":"codex-orchestrator-l51","type":"blocks","created_at":"2025-12-17T13:23:28.466761-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-dsc","title":"Bootstrap repo env before first tick (conda env creation + editable install) and avoid hard crash on missing deps","description":"Observed orchestrator runs failing on first validation because the target conda env exists but lacks repo install, leading to `ModuleNotFoundError: ava` / `src` and stopping the run. The orchestrator should proactively prepare the repo environment (and handle failures gracefully) rather than crashing the tick.","acceptance_criteria":"- On run start (before first bead execution), if a repo has `env` configured and `allow_env_creation=true`, orchestrator ensures the conda env exists (create if missing) and attempts to install the repo editable (`python -m pip install -e .`) before validation runs.\n- If the install step fails, the run records a clear, actionable error and marks the repo/bead blocked without crashing the orchestrator process.\n- Preflight env/bootstrap actions are logged in the run events and stdout/stderr logs for traceability.","status":"closed","priority":1,"issue_type":"bug","assignee":"cascade","created_at":"2026-01-14T11:31:03.761035-05:00","updated_at":"2026-01-14T11:47:15.891228-05:00","closed_at":"2026-01-14T11:47:15.891228-05:00","close_reason":"Implemented env bootstrap logic that runs before validation to ensure conda env exists and repo is installed editable","labels":["env","orchestrator","validation"]}
{"id":"codex-orchestrator-dw6","title":"Stop-the-line: allowed_roots must include orchestrator outputs","description":"The orchestrator writes outside typical code-only roots in managed repos, including:\n\n- run reports under `docs/runs/\u003cRUN_ID\u003e.md` (or equivalent)\n- Beads state under `.beads/*` (if the repo is managed via bd)\n\nIf repo `allowed_roots` does not include these paths, we risk:\n\n- safety boundary violations\n- persistent dirty-tree skips (repo becomes dirty due to orchestrator-owned outputs)\n\nWe need a coherent policy: `allowed_roots` must include all orchestrator-owned write locations, while `deny_roots` is used aggressively to prevent data/results mutation.","acceptance_criteria":"- Document required minimum `allowed_roots` for managed repos (at least `docs` (or chosen report dir) and `.beads` when bd is used).\n- Add validation that fails loudly (actionable error) if a repo’s configured roots do not permit orchestrator-owned outputs.\n- Provide an example configuration pattern in `config/repos.toml` guidance (e.g., allow `src/tests/notebooks/docs/.beads/metadata`, deny `data/results/...`).","notes":"Implemented fail-loud validation so repo safety boundaries always permit orchestrator-owned outputs:\n\n- `src/codex_orchestrator/repo_inventory.py`: `load_repo_inventory()` now hard-fails if a repo’s `allowed_roots`/`deny_roots` do not permit `.beads/` (Beads state) and `docs/runs/` (run reports), with actionable error messages.\n- `config/repos.toml`: documented the minimum required roots + an example tight-allowlist / aggressive-denylist pattern.\n- `tests/test_repo_inventory.py`: added coverage for missing required roots and deny_roots covering required outputs.\n\nLocal checks:\n- `.venv/bin/ruff check .`\n- `PATH=\"$(pwd)/.venv/bin:$PATH\" .venv/bin/pytest`","status":"closed","priority":0,"issue_type":"bug","assignee":"codex","created_at":"2025-12-16T22:59:02.916244-05:00","updated_at":"2025-12-18T12:28:15.080565-05:00","closed_at":"2025-12-18T12:28:15.080565-05:00","close_reason":"Added fail-loud repo config validation ensuring allowed_roots/deny_roots permit orchestrator outputs (.beads and docs/runs), plus docs + tests; ruff/pytest pass.","dependencies":[{"issue_id":"codex-orchestrator-dw6","depends_on_id":"codex-orchestrator-2","type":"discovered-from","created_at":"2025-12-16T22:59:02.917952-05:00","created_by":"daemon"},{"issue_id":"codex-orchestrator-dw6","depends_on_id":"codex-orchestrator-10","type":"discovered-from","created_at":"2025-12-16T22:59:02.919336-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-e8k","title":"Watchdog: detect and recover stuck codex attempts","description":"Add heartbeat/timeout handling so a started codex attempt that never emits codex_end is detected and deterministically failed/retried, with explicit event logging.","status":"open","priority":1,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-02-07T18:56:21.662249-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-07T18:56:21.662249-05:00","dependencies":[{"issue_id":"codex-orchestrator-e8k","depends_on_id":"codex-orchestrator-n9x","type":"discovered-from","created_at":"2026-02-07T18:56:21.663419-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-f84","title":"Add default dirty-ignore globs and auto-detect test artifacts on first tick","description":"Provide broader default dirty-ignore globs and auto-detect repo-specific transient paths (e.g., tests/data) on the first tick to avoid blocking runs. Include cleanup for ignored untracked files when enabled.","acceptance_criteria":"- Default dirty-ignore globs applied when computing git dirty state (common caches/build artifacts).\n- First tick scans untracked paths and auto-adds safe test-artifact globs when present (skipping prefixes with tracked files).\n- Optional cleanup removes ignored untracked paths when enabled; behavior is logged.\n- Tests cover default resolution and detection behavior.","notes":"Follow-up: forced `git status --porcelain -uall` so untracked artifacts are detected even if user git config hides them; resolves auto-detection tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T11:15:35.856578-05:00","updated_at":"2026-01-15T11:39:14.352582-05:00","closed_at":"2026-01-15T11:15:41.118412-05:00","close_reason":"Implemented default dirty-ignore globs, auto-detection, cleanup, and tests; wired into repo execution and final review.","labels":["git","orchestrator","quality"]}
{"id":"codex-orchestrator-g3r","title":"Auto-clean or isolate repo after failed bead to avoid dirty skip","description":"During RUN_ID=20260122-222658-5f201006, home_science and lab_tracker beads failed validation (pytest -q exit 2) after making changes; no commit was created and the worktrees were left dirty. Subsequent ticks skipped with git_dirty. We need a policy to keep repos clean after failed beads (e.g., auto-revert, or commit WIP and keep bead open, or isolate changes in a scratch worktree), so unattended runs can continue.","notes":"Added missing-module detection in validation retry context and env refresh when dependency files change (pyproject/environment/requirements). Dirty-worktree cleanup after failed bead still pending.","status":"closed","priority":1,"issue_type":"bug","owner":"samuel.brudner@gmail.com","created_at":"2026-01-22T20:31:28.02916-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-23T17:19:43.584728-05:00","closed_at":"2026-01-23T17:19:43.584728-05:00","close_reason":"Implemented failure snapshots and amend-on-close","dependencies":[{"issue_id":"codex-orchestrator-g3r","depends_on_id":"codex-orchestrator-9","type":"discovered-from","created_at":"2026-01-22T20:31:28.031144-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-gmf","title":"Handle bd init when .beads already exists (current bd returns exit=1)","description":"`codex-orchestrator overlay dry-run --repo-id autoencoded_vocal_analysis` failed because `bd init --quiet` exited 1 with 'Found existing database... This workspace is already initialized.' We should treat this condition as non-fatal (skip init if .beads/beads.db exists, or allow bd init exit=1 with that message). Affects planning/overlay flows that always call bd_init.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-13T22:33:01.05627-05:00","updated_at":"2026-01-13T22:35:16.523436-05:00","closed_at":"2026-01-13T22:35:16.523436-05:00","close_reason":"Skip bd init when .beads/beads.db already exists; added tests; overlay dry-run now succeeds."}
{"id":"codex-orchestrator-k5f","title":"CLI: add run signoff command","description":"Add a codex-orchestrator CLI command (e.g. codex-orchestrator signoff) to create run_signoff.json/md for a given RUN_ID (or latest ended run by default). Capture reviewer identity and timestamp; optionally notes. Must fail loud if run hasn’t ended or final review missing and can’t be generated.","acceptance_criteria":"- CLI command exists and is documented in --help output.\n- Can sign off a specific RUN_ID and the latest ended run.\n- Produces run_signoff.json and run_signoff.md.","notes":"Upstream `codex-orchestrator-l51` added run signoff model + writer in `src/codex_orchestrator/run_signoff.py`.\n\n- CLI should call `write_run_signoff(paths, run_id=..., reviewer=..., reviewed_at=..., notes=...)`.\n- Default RUN_ID selection helper: `find_latest_ended_run_id(paths)`.\n- `write_run_signoff` requires `run_end.json` to exist (run must be ended) and will auto-generate `final_review.json`/`final_review.md` if missing.\n- Validation helper: `validate_run_signoff(paths, run_id=...)` (fails loud on missing artifacts / parse errors / sha mismatch).","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2025-12-17T13:18:58.652745-05:00","updated_at":"2025-12-18T10:29:56.189198-05:00","closed_at":"2025-12-18T10:29:56.189198-05:00","close_reason":"Implemented `codex-orchestrator signoff` CLI command to write/validate run_signoff.json/md for a given RUN_ID or latest ended run (captures reviewer + timestamp; optional notes).","dependencies":[{"issue_id":"codex-orchestrator-k5f","depends_on_id":"codex-orchestrator-l51","type":"blocks","created_at":"2025-12-17T13:23:28.617275-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-kfe","title":"Inject commit message guidance into AGENTS.md for new repos","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-01-27T12:39:44.710037-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-27T12:44:34.128834-05:00","closed_at":"2026-01-27T12:44:34.128834-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-l51","title":"Run signoff artifacts: implement + validate","description":"Implement the run signoff artifact files run_signoff.json and run_signoff.md plus validation tying signoff to final_review.json via sha256. Provide helper APIs to find latest ended run and to validate signoff. Must fail loud on parse errors / mismatches.","acceptance_criteria":"- RunSignoff model, writer, and validator exist.\\n- Validation fails loudly on missing files, parse errors, and sha mismatch.","notes":"Completed.\n\n- Added run signoff artifacts + helpers in `src/codex_orchestrator/run_signoff.py`:\n  - `RunSignoff` (schema_version=1)\n  - `write_run_signoff(...)` -\u003e writes `run_signoff.json` + `run_signoff.md` (auto-generates `final_review.*` if missing)\n  - `find_latest_ended_run_id(paths)`\n  - `load_run_signoff(...)` / `validate_run_signoff(...)` (fails loud on missing artifacts, parse errors, RUN_ID mismatch, and sha256 mismatch)\n- Added `OrchestratorPaths.run_signoff_json_path()` / `OrchestratorPaths.run_signoff_md_path()` in `src/codex_orchestrator/paths.py`.\n\nTests: `conda run -n codex-orchestrator python -m pytest`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2025-12-17T13:19:31.058934-05:00","updated_at":"2025-12-17T13:40:38.744782-05:00","closed_at":"2025-12-17T13:40:38.744782-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-lcs","title":"Checkpoint: commit run reliability fixes + planner focus filtering","description":"Create a single commit for accumulated orchestrator run-stability changes plus planner-level focus filtering and tests.","status":"closed","priority":1,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-02-07T15:35:20.196934-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-07T15:36:19.844528-05:00","closed_at":"2026-02-07T15:36:19.844528-05:00","close_reason":"Committed as 4fec46b; includes run reliability fixes, planner-level focus deck filtering, CLI/help updates, and tests."}
{"id":"codex-orchestrator-lnq","title":"Planner: apply --focus as deck-entry filter","description":"Add planner-level focus gating so run/roadtrip focus limits which ready beads enter the run deck, not only execution prompts.","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-02-07T11:33:41.519042-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-07T11:42:27.230327-05:00","closed_at":"2026-02-07T11:42:27.230327-05:00","close_reason":"Implemented planner-level focus filtering for run decks; threaded focus through ensure_repo_run_deck; updated CLI help; added planner/planning-pass tests; pytest targeted suites passing."}
{"id":"codex-orchestrator-mlu","title":"Planning audit: strengthen conceptual-DRY heuristics","description":"Improve the conceptual-DRY / semantic-modeling audit heuristics so findings are more accurate and actionable.","acceptance_criteria":"- Add stronger signals for duplicated representations (e.g., repeated Pydantic models/dataclasses with similar fields, repeated config parsing patterns, repeated DTO shapes).\n- Include confidence rationale per finding (which signals triggered).\n- Deterministic output preserved for a given repo state.\n- Add unit tests for at least 2 representative heuristic cases.","notes":"Claimed for implementation: strengthen semantic-modeling / conceptual-DRY heuristics (model-shape + config parsing), add per-finding confidence rationale, and add unit tests for representative cases.\n\nCompleted:\n- `planning_audit` now parses scanned Python files with `ast` to extract model/DTO class shapes (Pydantic `BaseModel`/`BaseSettings`, `@dataclass`, `TypedDict`) and reports duplicate shape groups (exact field-set match, \u003e=3 fields).\n- Added config parsing pattern detection (e.g., `os.getenv`, `os.environ.get`, `yaml.safe_load`, `argparse.ArgumentParser`, etc) and a finding when patterns repeat across \u003e=3 modules.\n- Added `confidence_rationale` to every finding and surfaced it in Markdown output.\n- Deterministic ordering maintained via sorted outputs for failures, evidence paths, groups, and pattern lists.\n- Added unit tests for duplicate model shapes + repeated config parsing patterns.\n\nValidation:\n- `python -m pytest` (57 passed)\n- `ruff check .` (clean)","status":"closed","priority":2,"issue_type":"feature","assignee":"codex-cli","created_at":"2025-12-16T21:44:27.762012-05:00","updated_at":"2025-12-19T14:31:50.087812-05:00","closed_at":"2025-12-19T14:31:50.087812-05:00","close_reason":"Implemented AST-based model-shape + config-pattern heuristics with per-finding confidence rationale; added tests; all tests/lint pass.","dependencies":[{"issue_id":"codex-orchestrator-mlu","depends_on_id":"codex-orchestrator-n19","type":"discovered-from","created_at":"2025-12-16T21:44:27.764125-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-n19","title":"Planning-pass engineering desiderata audit (semantic modeling / conceptual DRY)","description":"During the per-repo first-run planning pass, evaluate the target repo against a small set of software-engineering desiderata (starting with semantic modeling / conceptual DRY). Detect cases where the same domain concept is represented in multiple incompatible ways (duplicate schemas/models/DTOs, repeated config parsing, ad-hoc dict shapes), and produce a concise audit artifact for the run. Optionally create/tag Beads issues in the target repo to capture actionable refactors.","acceptance_criteria":"Planner produces a deterministic audit artifact per repo per run (stored alongside the run deck and also referenced in the repo-local run report).\n\nThe audit includes at minimum:\n- Findings for semantic modeling / conceptual DRY (duplicated representations of core concepts)\n- Findings for restructuring ad-hoc analyses into config-driven pipelines/workflows (e.g., repeated manual multi-step analysis runs, scripts/notebooks with hardcoded paths/parameters, or duplicated analysis sequences that should be parameterized and orchestrated)\n- Suggested unifications (single authoritative model/module/class) and likely callsites\n- Suggested pipeline extractions (what should become a parameterized script/module, what should become a workflow step, and what should remain exploratory)\n- Confidence level + why (heuristics used)\n\nConservative replanning policy (v1):\n\n- Audit runs during the first-run planning pass per repo per RUN_ID and is reused across subsequent ticks.\n- Audit findings do not change the current run deck scope.\n\nThe audit is non-destructive by default (report-only). If configured/allowed, planner may create or tag Beads issues in the target repo for the top N actionable findings, linked as discovered-from the run/bead context; these issues are not automatically added to the current run deck.\n\nWorkflow escalation alignment:\n\n- Audit recommendations respect the workflow escalation policy: propose workflow engines (e.g., Snakemake) only for true multi-step dependency graphs; otherwise prefer minimal config-driven scripts/modules.\n\nIf audit cannot run (missing tooling), it fails loudly or is explicitly recorded as skipped with next action (per policy).","notes":"Implementation commit: b928daa\n\n- Added planning audit generation + deterministic JSON/MD artifacts during first planning pass.\n- Artifacts are written atomically and reused on subsequent ticks.\n- Repo run report and repo summary JSON now surface audit artifact paths + existence.\n- Added tests for creation/reuse/integration.\n\nTests: uv run --extra dev -m pytest (37 passed)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-15T09:33:02.982243-05:00","updated_at":"2025-12-16T21:41:12.538971-05:00","closed_at":"2025-12-16T21:41:12.538971-05:00","dependencies":[{"issue_id":"codex-orchestrator-n19","depends_on_id":"codex-orchestrator-4","type":"discovered-from","created_at":"2025-12-16T21:44:28.072746-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-n9x","title":"Hardening epic: run crash recovery and env-fidelity safeguards","description":"Address observed orchestrator failure modes from RUN_ID 20260207-205333-990da320: stalled codex attempts, stale current_run state, env mismatch between agent and validation, closed-bead retries, and instruction ambiguity.","status":"open","priority":1,"issue_type":"epic","owner":"samuel.brudner@gmail.com","created_at":"2026-02-07T16:36:54.161417-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-07T16:36:54.161417-05:00","dependencies":[{"issue_id":"codex-orchestrator-n9x","depends_on_id":"codex-orchestrator-d8q","type":"discovered-from","created_at":"2026-02-07T16:36:54.163304-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-nss","title":"Planning pass: detect notebook changes and create notebook-refactor beads","description":"The repo goals include proactively refactoring notebook code into `src/`, but current execution is bead-driven only.\n\nAdd planning-step notebook detection to:\n\n- detect modified/untracked `.ipynb` under `notebook_roots`\n- create/tag notebook-refactor beads that capture extraction work (and tests)\n- set dependencies so extraction blocks downstream work when appropriate","acceptance_criteria":"- Planning pass detects changed notebooks deterministically and proposes/creates notebook-refactor beads (behind a safe toggle if needed).\n- Created beads include clear contracts (time budget, validation commands) and dependency links.\n- Tests cover detection of modified/untracked `.ipynb` and bead creation behavior.","status":"closed","priority":2,"issue_type":"feature","assignee":"codex","created_at":"2025-12-16T22:59:03.293367-05:00","updated_at":"2025-12-16T23:47:50.610652-05:00","closed_at":"2025-12-16T23:47:50.610652-05:00","dependencies":[{"issue_id":"codex-orchestrator-nss","depends_on_id":"codex-orchestrator-4","type":"discovered-from","created_at":"2025-12-16T22:59:03.294923-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-o1z","title":"bd update returns list; parser expects object and crashes run","description":"Roadtrip run failed with BdCliError: `bd update \u003cid\u003e --json: expected object, got list`. Need to accept single-item list responses for bd update (and related commands).","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-13T23:00:49.95116-05:00","updated_at":"2026-01-13T23:01:06.951607-05:00","closed_at":"2026-01-13T23:01:06.951607-05:00","close_reason":"Accepted single-item list responses for bd update/close/create/show; added test; run should no longer crash on list output."}
{"id":"codex-orchestrator-ody","title":"Allow configurable ignore paths for git dirty checks (transient test artifacts)","description":"Orchestrator aborts runs when repo is dirty, but some repos create transient test artifacts (e.g., tests/data, .pytest_cache) that should not block unattended work. We need a configurable ignore list for dirty checks so known ephemeral paths don’t stop runs.","acceptance_criteria":"- Add a repo policy/overlay field (e.g., dirty_ignore_globs) to ignore matching paths when evaluating git dirty state.\n- Update git dirty check(s) to filter GitStatusEntry paths against this ignore list.\n- Ensure run start uses the filtered dirty check so ephemeral artifacts don’t block work.\n- Add tests covering ignored untracked paths vs. real changes.","notes":"Implemented dirty_ignore_globs + dirty_cleanup in repo policy, filtered git dirty checks, and added cleanup of ignored untracked paths; added tests for git dirty filtering/cleanup and repo inventory parsing; wired final review to ignore configured globs when config exists.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T12:19:54.641619-05:00","updated_at":"2026-01-14T12:57:01.917251-05:00","closed_at":"2026-01-14T12:57:01.917251-05:00","close_reason":"Added dirty ignore/cleanup config, filtered dirty checks + cleanup, and tests for behavior.","labels":["git","orchestrator","quality"]}
{"id":"codex-orchestrator-peu","title":"Stop-the-line: bd updates can leave target repo dirty","description":"In `execute_repo_tick()`, the orchestrator can:\n\n- Commit bead work (code/test changes)\n- Then run `bd update` / `bd close` / update dependents\n\nThose `bd_*` operations can modify `.beads/issues.jsonl` and `.beads/metadata.json` in the *target repo*.\n\nIf we do not end the tick with a clean working tree, the next scheduled tick will skip the repo (dirty-tree gate) and/or subsequent bead commits may accidentally include prior bead metadata changes.\n\nThis is a stop-the-line reliability bug for unattended runs.\n\nWe must choose and document a commit policy:\n\n- Option 1 (v1 recommended): exactly one commit per bead, and do NOT include commit hashes in bead notes.\n- Option 2: include commit hashes, but accept a second commit that captures `.beads/*` state changes.","acceptance_criteria":"- `execute_repo_tick(...)` leaves the target repo with `git status --porcelain` empty after completing a bead (including closing/updating beads and dependents).\n- Decide and document which commit policy is enforced (one-commit/no-hash vs two-commit/with-hash).\n- Add regression test: extend `tests/test_repo_execution_integration.py` to assert repo is clean after `execute_repo_tick(...)`.\n- Ensure the implementation cannot accidentally bundle prior bead `.beads/*` edits into the next bead’s commit.","notes":"Completed.\n\n- Enforced v1 commit policy: one commit per bead; Beads notes/close reasons do not include commit hashes.\n- `execute_repo_tick()` now amends the bead commit after `bd update`/`bd close`/dependent updates so the target repo ends clean.\n- Added `git_commit_amend_no_edit()` and a regression assertion that `git status --porcelain` is empty after a successful tick.\n- Updated docs in `project_spec.md` and `updates_checklist.md`.\n\nTests: `python -m pytest -q`","status":"closed","priority":0,"issue_type":"bug","assignee":"codex","created_at":"2025-12-16T22:59:02.653681-05:00","updated_at":"2025-12-17T11:23:33.821551-05:00","closed_at":"2025-12-17T11:23:33.821551-05:00","close_reason":"Fixed `execute_repo_tick()` so bd updates/close are captured in the bead commit (via amend), leaving the target repo clean; documented one-commit/no-hash policy and added regression test.","dependencies":[{"issue_id":"codex-orchestrator-peu","depends_on_id":"codex-orchestrator-10","type":"discovered-from","created_at":"2025-12-16T22:59:02.65631-05:00","created_by":"daemon"}]}
{"id":"codex-orchestrator-sxl","title":"Rename legacy codex- issue IDs to codex-orchestrator-","description":"Rename legacy codex-* issue IDs to codex-orchestrator-* using bd import --rename-on-import, then export/sync JSONL and commit to sync branch.","status":"closed","priority":2,"issue_type":"chore","owner":"samuel.brudner@gmail.com","created_at":"2026-01-28T22:24:12.531405-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-28T22:38:35.852501-05:00","closed_at":"2026-01-28T22:38:35.852501-05:00","close_reason":"Completed","dependencies":[{"issue_id":"codex-orchestrator-sxl","depends_on_id":"codex-orchestrator-2ln","type":"discovered-from","created_at":"2026-01-28T22:24:12.53304-05:00","created_by":"SamuelBrudner"}]}
{"id":"codex-orchestrator-thx","title":"a33: Final verification + commit + close","description":"Run full verification for planning audit hardening and LOC refactors (ruff, compileall, pytest), then commit changes and close codex-orchestrator-a33 and its subtasks.","acceptance_criteria":"- .venv/bin/ruff check . passes\n- python -m compileall -q src tests passes\n- pytest passes\n- Changes committed with bead-prefixed message\n- Subtasks and codex-orchestrator-a33 closed with notes","status":"closed","priority":2,"issue_type":"task","assignee":"gpt-5.2","created_at":"2025-12-19T10:28:32.891372-05:00","updated_at":"2025-12-19T14:07:39.901416-05:00","closed_at":"2025-12-19T14:07:39.901416-05:00","close_reason":"Closed via update"}
{"id":"codex-orchestrator-ufy","title":"On bead timeout, summarize attempt and split into smaller beads","notes":"Goal: when a bead fails due to time budget/timeout, record a concise summary of what was tried, problems encountered, and lessons learned, then automatically split into smaller follow-up beads (linked via discovered-from) so the next tick targets smaller tasks instead of retrying from scratch.","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-01-29T12:33:38.931636-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-29T12:42:38.419576-05:00","closed_at":"2026-01-29T12:42:38.419576-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-wf2","title":"Add repo initialization command for orchestrator onboarding","status":"closed","priority":1,"issue_type":"feature","owner":"samuel.brudner@gmail.com","created_at":"2026-02-06T14:08:00.157738-05:00","created_by":"SamuelBrudner","updated_at":"2026-02-06T14:12:53.077386-05:00","closed_at":"2026-02-06T14:12:53.077386-05:00","close_reason":"Completed"}
{"id":"codex-orchestrator-wy5","title":"Retry validation failures within bead ticks","status":"closed","priority":1,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-01-16T13:50:00.161782-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-16T14:04:42.761812-05:00","closed_at":"2026-01-16T14:04:42.761812-05:00","close_reason":"Done"}
{"id":"codex-orchestrator-zuk","title":"Ignore .beads/export-state in git status","status":"closed","priority":2,"issue_type":"chore","owner":"samuel.brudner@gmail.com","created_at":"2026-01-29T21:11:07.035104-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-29T21:23:02.785471-05:00","closed_at":"2026-01-29T21:23:02.785471-05:00","close_reason":"Completed"}
{"id":"codex-wy5","title":"Retry validation failures within bead ticks","status":"tombstone","priority":1,"issue_type":"task","owner":"samuel.brudner@gmail.com","created_at":"2026-01-16T13:50:00.161782-05:00","created_by":"SamuelBrudner","updated_at":"2026-01-28T22:43:32.660807-05:00","close_reason":"Done","deleted_at":"2026-01-28T22:43:32.660807-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
